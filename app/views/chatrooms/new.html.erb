<%= form_for @room do |f| %>
	<div class="modal-header">
	  <h3 class="modal-title">What do you want to talk?</h5>
	</div>
	<div class="modal-body action-new">
	  <div class='container'>
			<div class='row'>
				<div class='form-group'>
					<div class='input-group'>
						<label>主題：<%= f.text_field :title, class: 'form-control', required: true %></label>
					</div>
				</div>
				<div class='form-group'>
					<div class='input-group'>
						<label>類別：</label>
						<%= select_tag :main_category, options_for_select(@categories.collect{ |c| [c.name, c.id]}), class: 'form-control' %>
					</div>
				</div>
				<div class='form-group'>
					<div class='input-group'>
						<label>子類別：</label>
						<%= f.collection_select(:category_id, @sub_categories, :id, :name, {:prompt => 'Select'}, {class: 'form-control', id: 'sub_category_options', required: true}) %>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="modal-footer">
		<%= f.submit '送出', class: 'btn btn-primary' %>
	  <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
	</div>
<% end %>

<script type="text/javascript">
	if ($('.action-new').length != 0) {
	    $("#main_category")
	        .change(function() {
	            var category_id = '';
	            category_id = $("#main_category option:selected").val();
	            $.ajax({
	                url: "<%= get_sub_category_path %>" + '?id=' + category_id,
	                type: "get",
	                dataType: "json",
	                contentType: 'application/json',
	                success: function(data) {
	                    $('#sub_category_options option').remove();

	                    for (var key in data) {
	                        $("#sub_category_options").append($("<option></option>").attr("value", data[key].id).text(data[key].name));
	                    }
	                }
	            });
	        });
	};
</script>